<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="androidMapper">

	<resultMap type="MemberDTO" id="memberMap">
		<id column="member_id" property="userId" />
		<result column="password" property="password" />
		<result column="sex" property="sex" />
		<result column="pre_addr" property="preAddr" />
		<result column="detail_addr" property="detailAddr" />
		<result column="name" property="name" />
	</resultMap>

	<insert id="signIn" parameterType="MemberDTO">
		insert into
		member(member_id,name,password,sex,pre_addr,detail_addr,self_img,join_date,state,member_latitude,member_longitude)
		values(#{userId},#{name},#{password},#{sex},#{preAddr},#{detailAddr},#{selfImg},sysdate,#{state},#{latitude},#{longitude})
	</insert>

	<update id="updateToken" parameterType="map">
		update member set token =
		#{token} where member_id = #{id}
	</update>

	<select id="selectTokenByDistance" resultType="string"
		parameterType="map">
		select token from member where
		(6371*acos(cos(radians(#{latitude}))*cos(radians(MEMBER_LATITUDE))*cos(radians(MEMBER_LONGITUDE)
		-radians(#{longitude}))+sin(radians(#{latitude}))*sin(radians(MEMBER_LATITUDE))))
		&lt;= #{distance} and token is not null
	</select>

</mapper>